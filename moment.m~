% Function that returns the momement about the origin of coordinates
% of the wing given the lift of each element and its position.
function M = moment(dL,Nx,Ny,Xp,cas)
    switch cas
        case 'ala'
            Mw = 0;
            Xp_w = rearrange_wing(Nx,Ny,Xp,'wing');
            for j=1:Ny
                for i=1:Nx
            %             what to do with: ground effect and with vortex where there is
            %             no other vortex at j+1?
                  Xpm = (Xp_w(i,j)+Xp_w(i,j+1))/2;
                  Mw = Mw + Xpm*dL(i,j);  
                end
            end
        case 'ala+htp'
            Mw = 0;
            Mh = 0;
            Xp_w = rearrange_wing(Nx,Ny,Xp,'wing');
            Xp_h = rearrange_wing(Nx,Ny,Xp,'htp');
            for j=1:Ny
                for i=1:Nx
            %             what to do with: ground effect and with vortex where there is
            %             no other vortex at j+1?
                  Xpmw = (Xp_w(i,j)+Xp_w(i,j+1))/2;
                  Mw = Mw + Xpmw*dL(i,j);
                  Xpmh = (Xp_h(i,j)+Xp_h(i,j+1))/2;
                  Mh = Mh + Xpmh*dL(i,j);                    
                end
            end            
        case 'ala+htp+vtp'
            Mw=0;
            Mh=0;
            Mv=0;
            Xp_w = rearrange_wing(Nx,Ny,Xp,'wing');
            Xp_h = rearrange_wing(Nx,Ny,Xp,'htp');
            Xp_v = rearrange_wing(Nx,Ny,Xp,'vtp');
            for j=1:Ny
                for i=1:Nx
            %             what to do with: ground effect and with vortex where there is
            %             no other vortex at j+1?
                  Xpmw = (Xp_w(i,j)+Xp_w(i,j+1))/2;
                  Mw = Mw + Xpmw*dL(i,j);
                  Xpmh = (Xp_h(i,j)+Xp_h(i,j+1))/2;
                  Mh = Mh + Xpmh*dL(i,j);
                  Xpmv = (Xp_h(i,j)+Xp_h(i,j+1))/2;
                  Mh = Mh + Xpmh*dL(i,j);                  
                end
            end            
    end

    M = -M;
end
